{% extends 'base.html' %}
{% block content %}
<h1 class="font-bold text-bp-blue mb-2">{{ meeting.title }}</h1>
<p class="mb-4">Stage: {{ meeting.status or 'Draft' }} | Members: {{ member_count }}</p>
{% if meeting.opens_at_stage1 and meeting.closes_at_stage1 %}
<p class="mb-2">
  Stage 1:
  {{ meeting.opens_at_stage1|format_dt }} –
  {{ meeting.closes_at_stage1|format_dt }}
  <a href="{{ stage1_ics_url }}" class="text-bp-blue hover:underline ml-2">Add to calendar</a>
</p>
{% endif %}
{% if meeting.runoff_opens_at and meeting.runoff_closes_at %}
<p class="mb-2">
  Run-off:
  {{ meeting.runoff_opens_at|format_dt }} –
  {{ meeting.runoff_closes_at|format_dt }}
  <a href="{{ runoff_ics_url }}" class="text-bp-blue hover:underline ml-2">Add to calendar</a>
</p>
{% endif %}
{% if meeting.opens_at_stage2 and meeting.closes_at_stage2 %}
<p class="mb-4">
  Stage 2:
  {{ meeting.opens_at_stage2|format_dt }} –
  {{ meeting.closes_at_stage2|format_dt }}
  <a href="{{ stage2_ics_url }}" class="text-bp-blue hover:underline ml-2">Add to calendar</a>
</p>
<div class="mb-6">
  <div class="bp-progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="{{ meeting.stage2_progress_percent() }}">
    <div class="bp-progress-bar" style="width: {{ meeting.stage2_progress_percent() }}%"></div>
    <span class="sr-only">{{ meeting.stage2_progress_percent() }}% complete</span>
  </div>
  <span class="text-xs text-bp-grey-600 mt-1">{{ meeting.stage2_progress_percent() }}% of Stage 2 voting window elapsed</span>
</div>
{% endif %}
<button class="bp-btn-secondary mb-4" data-modal-target="resend-modal">Resend Voting Email</button>
<dialog id="resend-modal" class="bp-card w-full max-w-md" role="dialog" aria-labelledby="resend-title">
  <h2 id="resend-title" class="font-bold mb-2">Request Voting Email</h2>
  <div id="resend-modal-content" hx-target="this" hx-swap="outerHTML">
    {% include 'resend_modal_content.html' %}
  </div>
  <button class="bp-btn-secondary mt-4" data-close-modal>Close</button>
</dialog>
{% endblock %}
